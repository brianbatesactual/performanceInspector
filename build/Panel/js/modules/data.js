!function(e){var t,r=e.each,n=HighchartsAdapter.inArray,s=e.splat,o=function(e,t){this.init(e,t)};e.extend(o.prototype,{init:function(e,t){this.options=e,this.chartOptions=t,this.columns=e.columns||this.rowsToColumns(e.rows)||[],this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var n,s,o=this.chartOptions,i=this.options,a=[],l=function(t){return(e.seriesTypes[t||"line"].prototype.pointArrayMap||[0]).length},u=o&&o.chart&&o.chart.type,h=[],d=[];r(o&&o.series||[],function(e){h.push(l(e.type||u))}),r(i&&i.seriesMapping||[],function(e){a.push(e.x||0)}),0===a.length&&a.push(0),r(i&&i.seriesMapping||[],function(r){var i,a=new t,m=h[n]||l(u),p=e.seriesTypes[((o&&o.series||[])[n]||{}).type||u||"line"].prototype.pointArrayMap||["y"];a.addColumnReader(r.x,"x");for(i in r)r.hasOwnProperty(i)&&"x"!==i&&a.addColumnReader(r[i],i);for(s=0;m>s;s++)a.hasReader(p[s])||a.addColumnReader(void 0,p[s]);d.push(a),n++}),i=e.seriesTypes[u||"line"].prototype.pointArrayMap,void 0===i&&(i=["y"]),this.valueCount={global:l(u),xColumns:a,individual:h,seriesBuilders:d,globalPointArrayMap:i}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),this.findHeaderRow(),this.parsed()!==!1&&this.complete()},parseCSV:function(){var e,t,n=this,s=this.options,o=s.csv,i=this.columns,a=s.startRow||0,l=s.endRow||Number.MAX_VALUE,u=s.startColumn||0,h=s.endColumn||Number.MAX_VALUE,d=0;o&&(t=o.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(s.lineDelimiter||"\n"),e=s.itemDelimiter||(-1!==o.indexOf("	")?"	":","),r(t,function(t,s){var o=n.trim(t),m=0===o.indexOf("#");s>=a&&l>=s&&!m&&""!==o&&(o=t.split(e),r(o,function(e,t){t>=u&&h>=t&&(i[t-u]||(i[t-u]=[]),i[t-u][d]=e)}),d+=1)}),this.dataFound())},parseTable:function(){var e=this.options,t=e.table,n=this.columns,s=e.startRow||0,o=e.endRow||Number.MAX_VALUE,i=e.startColumn||0,a=e.endColumn||Number.MAX_VALUE;t&&("string"==typeof t&&(t=document.getElementById(t)),r(t.getElementsByTagName("tr"),function(e,t){t>=s&&o>=t&&r(e.children,function(e,r){("TD"===e.tagName||"TH"===e.tagName)&&r>=i&&a>=r&&(n[r-i]||(n[r-i]=[]),n[r-i][t-s]=e.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var e,t,r=this,n=this.options,s=n.googleSpreadsheetKey,o=this.columns,i=n.startRow||0,a=n.endRow||Number.MAX_VALUE,l=n.startColumn||0,u=n.endColumn||Number.MAX_VALUE;s&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+s+"/"+(n.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:n.error,success:function(n){var s,h,n=n.feed.entry,d=n.length,m=0,p=0;for(h=0;d>h;h++)s=n[h],m=Math.max(m,s.gs$cell.col),p=Math.max(p,s.gs$cell.row);for(h=0;m>h;h++)h>=l&&u>=h&&(o[h-l]=[],o[h-l].length=Math.min(p,a-i));for(h=0;d>h;h++)s=n[h],e=s.gs$cell.row-1,t=s.gs$cell.col-1,t>=l&&u>=t&&e>=i&&a>=e&&(o[t-l][e-i]=s.content.$t);r.dataFound()}})},findHeaderRow:function(){var e=0;r(this.columns,function(t){t.isNumeric&&"string"!=typeof t[0]&&(e=null)}),this.headerRow=e},trim:function(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,""):e},parseTypes:function(){for(var e,t,r,o,i,a,l,u=this.columns,h=this.rawColumns,d=u.length,m=[],p=this.chartOptions;d--;){for(e=u[d].length,h[d]=[],l=(i=-1!==n(d,this.valueCount.xColumns))&&p&&p.xAxis&&"category"===s(p.xAxis)[0].type;e--;)t=m[e]||u[d][e],r=parseFloat(t),o=h[d][e]=this.trim(t),l?u[d][e]=o:o==r?(u[d][e]=r,r>31536e6?u[d].isDatetime=!0:u[d].isNumeric=!0):(r=this.parseDate(t),i&&"number"==typeof r&&!isNaN(r)?(m[e]=t,u[d][e]=r,u[d].isDatetime=!0,void 0!==u[d][e+1]&&(t=r>u[d][e+1],t!==a&&void 0!==a&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,e=u[d].length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):u[d].unsorted=!0),a=t)):(u[d][e]=""===o?null:o,0!==e&&(u[d].isDatetime||u[d].isNumeric)&&(u[d].mixed=!0)));i&&u[d].mixed&&(u[d]=h[d])}if(u[0].isDatetime&&a)for(h="number"!=typeof u[0][0],d=0;d<u.length;d++)u[d].reverse(),h&&u[d].unshift(u[d].pop())},dateFormats:{"YYYY-mm-dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[1],e[2]-1,+e[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[2]-1,+e[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[1]-1,+e[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[3]+2e3,e[2]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return console.log(e),Date.UTC(+e[3]+2e3,e[1]-1,+e[2])}}},parseDate:function(e){var t,r,n,s=this.options.parseDate,o=this.options.dateFormat||this.dateFormat;if(s&&(t=s(e)),"string"==typeof e){if(o)s=this.dateFormats[o],(n=e.match(s.regex))&&(t=s.parser(n));else for(r in this.dateFormats)if(s=this.dateFormats[r],n=e.match(s.regex)){this.dateFormat=r,this.alternativeFormat=s.alternative,t=s.parser(n);break}n||(n=Date.parse(e),"object"==typeof n&&null!==n&&n.getTime?t=n.getTime()-6e4*n.getTimezoneOffset():"number"==typeof n&&!isNaN(n)&&(t=n-6e4*new Date(n).getTimezoneOffset()))}return t},rowsToColumns:function(e){var t,r,n,s,o;if(e)for(o=[],r=e.length,t=0;r>t;t++)for(s=e[t].length,n=0;s>n;n++)o[n]||(o[n]=[]),o[n][t]=e[t][n];return o},parsed:function(){return this.options.parsed?this.options.parsed.call(this,this.columns):void 0},getFreeIndexes:function(e,t){var r,n,s,o=[],i=[];for(n=0;e>n;n+=1)o.push(!0);for(r=0;r<t.length;r+=1)for(s=t[r].getReferencedColumnIndexes(),n=0;n<s.length;n+=1)o[s[n]]=!1;for(n=0;n<o.length;n+=1)o[n]&&i.push(n);return i},complete:function(){var e,r,s,o,i,a,l=this.columns,u=this.options,h=[];if(u.complete||u.afterComplete){for(o=0;o<l.length;o++)0===this.headerRow&&(l[o].name=l[o].shift());for(r=[],s=this.getFreeIndexes(l.length,this.valueCount.seriesBuilders),o=0;o<this.valueCount.seriesBuilders.length;o++)a=this.valueCount.seriesBuilders[o],a.populateColumns(s)&&h.push(a);for(;s.length>0;){for(a=new t,a.addColumnReader(0,"x"),o=n(0,s),-1!==o&&s.splice(o,1),o=0;o<this.valueCount.global;o++)a.addColumnReader(void 0,this.valueCount.globalPointArrayMap[o]);a.populateColumns(s)&&h.push(a)}if(h.length>0&&h[0].readers.length>0&&(a=l[h[0].readers[0].columnIndex],void 0!==a&&(a.isDatetime?e="datetime":a.isNumeric||(e="category"))),"category"===e)for(o=0;o<h.length;o++)for(a=h[o],s=0;s<a.readers.length;s++)"x"===a.readers[s].configName&&(a.readers[s].configName="name");for(o=0;o<h.length;o++){for(a=h[o],s=[],i=0;i<l[0].length;i++)s[i]=a.read(l,i);r[o]={data:s},a.name&&(r[o].name=a.name)}l={xAxis:{type:e},series:r},u.complete&&u.complete(l),u.afterComplete&&u.afterComplete(l)}}}),e.Data=o,e.data=function(e,t){return new o(e,t)},e.wrap(e.Chart.prototype,"init",function(t,r,n){var s=this;r&&r.data?e.data(e.extend(r.data,{afterComplete:function(o){var i,a;if(r.hasOwnProperty("series"))if("object"==typeof r.series)for(i=Math.max(r.series.length,o.series.length);i--;)a=r.series[i]||{},r.series[i]=e.merge(a,o.series[i]);else delete r.series;r=e.merge(o,r),t.call(s,r,n)}}),r):t.call(s,r,n)}),t=function(){this.readers=[],this.pointIsArray=!0},t.prototype.populateColumns=function(e){var t=!0;return r(this.readers,function(t){void 0===t.columnIndex&&(t.columnIndex=e.shift())}),r(this.readers,function(e){void 0===e.columnIndex&&(t=!1)}),t},t.prototype.read=function(e,t){var n,s=this.pointIsArray,o=s?[]:{};return r(this.readers,function(r){var n=e[r.columnIndex][t];s?o.push(n):o[r.configName]=n}),void 0===this.name&&this.readers.length>=2&&(n=this.getReferencedColumnIndexes(),n.length>=2)&&(n.shift(),n.sort(),this.name=e[n.shift()].name),o},t.prototype.addColumnReader=function(e,t){this.readers.push({columnIndex:e,configName:t}),"x"!==t&&"y"!==t&&void 0!==t&&(this.pointIsArray=!1)},t.prototype.getReferencedColumnIndexes=function(){var e,t,r=[];for(e=0;e<this.readers.length;e+=1)t=this.readers[e],void 0!==t.columnIndex&&r.push(t.columnIndex);return r},t.prototype.hasReader=function(e){var t,r;for(t=0;t<this.readers.length;t+=1)if(r=this.readers[t],r.configName===e)return!0}}(Highcharts);